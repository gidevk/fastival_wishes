<!DOCTYPE html>
<html lang="hi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>‡§∞‡§ï‡•ç‡§∑‡§æ‡§¨‡§Ç‡§ß‡§® 2025 ‡§∂‡•Å‡§≠‡§ï‡§æ‡§Æ‡§®‡§æ‡§è‡§Ç</title>
  <style>
    * {
      box-sizing: border-box;
    }
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      background: #ffebee;
      padding: 20px;
      margin: 0;
    }
    .container {
      width: 100%;
      max-width: 400px;
      margin: auto;
      background: white;
      border-radius: 10px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      padding: 20px;
    }
    img {
      width: 100%;
      height: auto;
      border-radius: 10px;
      margin-bottom: 15px;
    }
    .image-options {
      display: flex;
      overflow-x: auto;
      gap: 10px;
      padding: 10px 0;
      margin: 15px 0;
    }
    .image-option {
      width: 80px;
      height: 80px;
      border-radius: 8px;
      border: 2px solid transparent;
      cursor: pointer;
      object-fit: cover;
    }
    .image-option.selected {
      border-color: #f06292;
    }
    input[type="text"] {
      width: 100%;
      padding: 12px;
      margin: 15px 0;
      font-size: 16px;
      border-radius: 8px;
      border: 1px solid #ddd;
    }
    button {
      margin-top: 10px;
      padding: 12px 20px;
      font-size: 16px;
      background-color: #f06292;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      width: 100%;
    }
    .share-message {
      background: #fff5f5;
      padding: 12px;
      border-radius: 8px;
      margin: 15px 0;
      font-size: 14px;
    }
    #loading {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.5);
      z-index: 1000;
      justify-content: center;
      align-items: center;
      color: white;
      font-size: 20px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üå∏ ‡§∞‡§ï‡•ç‡§∑‡§æ‡§¨‡§Ç‡§ß‡§® 2025 ‡§ï‡•Ä ‡§∂‡•Å‡§≠‡§ï‡§æ‡§Æ‡§®‡§æ‡§è‡§Ç üå∏</h1>
    
    <img src="rakhi1.jpg" alt="‡§∞‡§ï‡•ç‡§∑‡§æ‡§¨‡§Ç‡§ß‡§®" id="rakhiImage">
    
    <div class="image-options">
      <img src="rakhi1.jpg" class="image-option selected" onclick="changeImage(this, 'rakhi1.jpg')">
      <img src="rakhi2.jpg" class="image-option" onclick="changeImage(this, 'rakhi2.jpg')">
      <img src="rakhi3.jpg" class="image-option" onclick="changeImage(this, 'rakhi3.jpg')">
      <img src="rakhi4.jpg" class="image-option" onclick="changeImage(this, 'rakhi4.jpg')">
      <img src="rakhi5.jpg" class="image-option" onclick="changeImage(this, 'rakhi5.jpg')">
    </div>
    
    <div class="share-message">
      ‡§á‡§® ‡§™‡•ç‡§Ø‡§æ‡§∞‡•Ä ‡§∂‡•Å‡§≠‡§ï‡§æ‡§Æ‡§®‡§æ‡§ì‡§Ç ‡§ï‡•ã ‡§∏‡§æ‡§ù‡§æ ‡§ï‡§∞‡•á‡§Ç ‡§î‡§∞ ‡§Ö‡§™‡§®‡•á ‡§™‡•ç‡§∞‡§ø‡§Ø‡§ú‡§®‡•ã‡§Ç ‡§ï‡•ã ‡§ñ‡•Å‡§∂‡•Ä ‡§¶‡•á‡§Ç!
    </div>
    
    <input type="text" id="senderName" placeholder="‡§Ü‡§™‡§ï‡§æ ‡§®‡§æ‡§Æ">
    <button onclick="shareOnWhatsApp()">WhatsApp ‡§™‡§∞ ‡§∂‡•á‡§Ø‡§∞ ‡§ï‡§∞‡•á‡§Ç</button>
  </div>

  <div id="loading">‡§§‡•à‡§Ø‡§æ‡§∞ ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à... ‡§ï‡•É‡§™‡§Ø‡§æ ‡§™‡•ç‡§∞‡§§‡•Ä‡§ï‡•ç‡§∑‡§æ ‡§ï‡§∞‡•á‡§Ç</div>

  <script>
    let selectedImageUrl = 'rakhi1.jpg';
    const websiteUrl = 'https://fastival-wishes.vercel.app/';
    
    function changeImage(element, imageUrl) {
      document.getElementById('rakhiImage').src = imageUrl;
      selectedImageUrl = imageUrl;
      document.querySelectorAll('.image-option').forEach(img => {
        img.classList.remove('selected');
      });
      element.classList.add('selected');
    }
    
    function shareOnWhatsApp() {
      const name = document.getElementById("senderName").value.trim() || "‡§≠‡•à‡§Ø‡§æ";
      const loading = document.getElementById('loading');
      
      const wishes = [
        `üíñ ‡§∞‡§ï‡•ç‡§∑‡§æ‡§¨‡§Ç‡§ß‡§® ‡§ï‡•Ä ‡§π‡§æ‡§∞‡•ç‡§¶‡§ø‡§ï ‡§∂‡•Å‡§≠‡§ï‡§æ‡§Æ‡§®‡§æ‡§è‡§Ç!\n‡§Ü‡§™‡§ï‡§æ ${name}`,
        `üå∏ ‡§≠‡§ó‡§µ‡§æ‡§® ‡§Ü‡§™‡§ï‡•ã ‡§ñ‡•Å‡§∂‡§ø‡§Ø‡§æ‡§Å ‡§¶‡•á‡§Ç!\n‡§Ü‡§™‡§ï‡§æ ${name}`,
        `üíù ‡§™‡•ç‡§Ø‡§æ‡§∞ ‡§î‡§∞ ‡§∏‡§Æ‡•ç‡§Æ‡§æ‡§® ‡§ï‡•á ‡§∏‡§æ‡§•!\n‡§Ü‡§™‡§ï‡§æ ${name}`,
        `‚ú® ‡§Ü‡§™‡§ï‡•á ‡§ú‡•Ä‡§µ‡§® ‡§Æ‡•á‡§Ç ‡§ñ‡•Å‡§∂‡§ø‡§Ø‡§æ‡§Å ‡§≠‡§∞ ‡§¶‡•á‡§Ç!\n‡§Ü‡§™‡§ï‡§æ ${name}`,
        `üéÄ ‡§π‡§Æ‡•á‡§∂‡§æ ‡§∏‡§æ‡§• ‡§∞‡§π‡•á‡§Ç‡§ó‡•á!\n‡§Ü‡§™‡§ï‡§æ ${name}`
      ];
      
      const randomWish = wishes[Math.floor(Math.random() * wishes.length)];
      const fullMessage = `${randomWish}\n\n‡§Ö‡§ß‡§ø‡§ï ‡§∂‡•Å‡§≠‡§ï‡§æ‡§Æ‡§®‡§æ‡§è‡§Ç ‡§≠‡•á‡§ú‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ø‡§π‡§æ‡§Å ‡§ú‡§æ‡§è‡§Ç: ${websiteUrl}`;
      
      loading.style.display = 'flex';
      
      // Create a canvas to combine image and text
      const canvas = document.createElement('canvas');
      const ctx = canvas.getContext('2d');
      const img = new Image();
      img.crossOrigin = 'Anonymous';
      img.src = selectedImageUrl;
      
      img.onload = function() {
        canvas.width = img.width;
        canvas.height = img.height + 100; // Extra space for text
        
        // Draw image
        ctx.drawImage(img, 0, 0, img.width, img.height);
        
        // Add text background
        ctx.fillStyle = 'rgba(255, 255, 255, 0.7)';
        ctx.fillRect(0, img.height, img.width, 100);
        
        // Add text
        ctx.fillStyle = '#d81b60';
        ctx.font = 'bold 18px Arial';
        const lines = randomWish.split('\n');
        
        // Draw each line of text
        lines.forEach((line, index) => {
          ctx.fillText(line, 20, img.height + 30 + (index * 25));
        });
        
        // Convert canvas to blob
        canvas.toBlob(function(blob) {
          const imageUrl = URL.createObjectURL(blob);
          
          // For mobile devices
          if (/Android|iPhone|iPad/i.test(navigator.userAgent)) {
            if (navigator.share) {
              // Use Web Share API if available
              const file = new File([blob], 'raksha-bandhan.jpg', { type: 'image/jpeg' });
              navigator.share({
                title: '‡§∞‡§ï‡•ç‡§∑‡§æ‡§¨‡§Ç‡§ß‡§® ‡§∂‡•Å‡§≠‡§ï‡§æ‡§Æ‡§®‡§æ‡§è‡§Ç',
                text: fullMessage,
                files: [file]
              }).catch(err => {
                console.error('Share failed:', err);
                // Fallback to WhatsApp with text only
                window.location.href = `whatsapp://send?text=${encodeURIComponent(fullMessage)}`;
              }).finally(() => {
                loading.style.display = 'none';
              });
            } else {
              // Fallback for mobile browsers without Web Share API
              // First download the image
              const downloadLink = document.createElement('a');
              downloadLink.href = imageUrl;
              downloadLink.download = 'raksha-bandhan-wish.jpg';
              document.body.appendChild(downloadLink);
              downloadLink.click();
              document.body.removeChild(downloadLink);
              
              // Then open WhatsApp with the text
              setTimeout(() => {
                window.location.href = `whatsapp://send?text=${encodeURIComponent(fullMessage)}`;
                loading.style.display = 'none';
              }, 1000);
            }
          } else {
            // For desktop - download image and open WhatsApp web
            const downloadLink = document.createElement('a');
            downloadLink.href = imageUrl;
            downloadLink.download = 'raksha-bandhan-wish.jpg';
            document.body.appendChild(downloadLink);
            downloadLink.click();
            document.body.removeChild(downloadLink);
            
            // Open WhatsApp web
            window.open(`https://web.whatsapp.com/send?text=${encodeURIComponent(fullMessage)}`);
            loading.style.display = 'none';
          }
          
          // Clean up
          setTimeout(() => URL.revokeObjectURL(imageUrl), 1000);
        }, 'image/jpeg', 0.9);
      };
      
      img.onerror = function() {
        // If image fails to load, just share text
        loading.style.display = 'none';
        if (/Android|iPhone|iPad/i.test(navigator.userAgent)) {
          window.location.href = `whatsapp://send?text=${encodeURIComponent(fullMessage)}`;
        } else {
          window.open(`https://web.whatsapp.com/send?text=${encodeURIComponent(fullMessage)}`);
        }
      };
    }
  </script>
</body>
</html>